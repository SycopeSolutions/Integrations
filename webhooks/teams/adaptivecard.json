{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.5",
  "body": [
{
  "type": "Container",
  "style": "@{if(equals(toLower(body('Parse_JSON')?['severity']),'critical'),'attention', if(equals(toLower(body('Parse_JSON')?['severity']),'high'),'attention', if(equals(toLower(body('Parse_JSON')?['severity']),'medium'),'warning', if(equals(toLower(body('Parse_JSON')?['severity']),'low'),'good','emphasis'))))}",
  "bleed": true,
  "items": [
    {
      "type": "TextBlock",
      "text": "@{coalesce(body('Parse_JSON')?['name'],'Sycope Alert')}",
      "size": "Large",
      "weight": "Bolder",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "spacing": "None",
      "isSubtle": true,
      "wrap": true,
      "text": "Severity: **@{if(equals(toLower(body('Parse_JSON')?['severity']),'critical'),'‚ùó Critical', if(equals(toLower(body('Parse_JSON')?['severity']),'high'),'üî¥ High', if(equals(toLower(body('Parse_JSON')?['severity']),'medium'),'üü† Medium', if(equals(toLower(body('Parse_JSON')?['severity']),'low'),'üü¢ Low', if(equals(toLower(body('Parse_JSON')?['severity']),'info'),'‚ÑπÔ∏è Info','-')))))}** ‚Ä¢ Rule: @{coalesce(body('Parse_JSON')?['ruleType'],'n/a')} ‚Ä¢ Time: @{coalesce(body('Parse_JSON')?['timestamp'], string(body('Parse_JSON')?['unixTimestamp']))}"
    }
  ]
},
{
  "type": "ColumnSet",
  "columns": [
    {
      "type": "Column",
      "width": "stretch",
      "items": [
        { "type": "TextBlock", "text": "**Time**", "wrap": true },
        {
          "type": "TextBlock",
          "text": "@{coalesce(body('Parse_JSON')?['timestamp'], string(body('Parse_JSON')?['unixTimestamp']))}",
          "wrap": true,
          "spacing": "Small"
        },
        { "type": "TextBlock", "text": "**Threshold**", "wrap": true, "spacing": "Medium" },
        {
          "type": "TextBlock",
          "wrap": true,
          "spacing": "Small",
          "text": "@{if(equals(toLower(body('Parse_JSON')?['alertFlagThresholdLevel']),'critical'),'‚ùó Critical', if(equals(toLower(body('Parse_JSON')?['alertFlagThresholdLevel']),'major'),'‚ö†Ô∏è Major', if(equals(toLower(body('Parse_JSON')?['alertFlagThresholdLevel']),'minor'),'‚ÑπÔ∏è Minor','-')))}"
        }
      ]
    },
    {
      "type": "Column",
      "width": "stretch",
      "items": [
        { "type": "TextBlock", "text": "**Client IP**", "wrap": true },
        {
          "type": "Container",
          "style": "emphasis",
          "bleed": false,
          "items": [
            {
              "type": "TextBlock",
              "text": "@{coalesce(body('Parse_JSON')?['clientIp']?['addressString'],'-')}",
              "fontType": "Monospace",
              "weight": "Bolder",
              "color": "Accent",
              "wrap": true
            }
          ],
          "spacing": "Small"
        },
        { "type": "TextBlock", "text": "**Server IP**", "wrap": true, "spacing": "Medium" },
        {
          "type": "Container",
          "style": "emphasis",
          "bleed": false,
          "items": [
            {
              "type": "TextBlock",
              "text": "@{coalesce(body('Parse_JSON')?['serverIp']?['addressString'],'-')}",
              "fontType": "Monospace",
              "weight": "Bolder",
              "color": "Accent",
              "wrap": true
            }
          ],
          "spacing": "Small"
        }
      ]
    }
  ]
},
    {
      "type": "Container",
      "separator": true,
      "items": [
        {
          "type": "TextBlock",
          "isSubtle": true,
          "wrap": true,
          "text": "üîé This alert was automatically generated by the Sycope monitoring solution."
        }
      ]
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "üîó View in Sycope",
      "url": "@{variables('sycopeLink')}"
    }
  ]
}
